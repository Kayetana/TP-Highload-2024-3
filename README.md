# Highload Twitter

## 1. Тема и целевая аудитория
Твиттер - сервис микроблогов и социальная сеть, в которой пользователи публикуют сообщения, известные как твиты.

### Целевая аудитория

Целевая аудитория Твиттера включает миллионы пользователей по всему миру.  

Топ-10 стран по месячной аудитории (MAU)  
_Данные основаны на показателях рекламных охватов Твиттера, опубликованных в апреле 2023 года._ [[1]](https://datareportal.com/essential-twitter-stats)

| Страна            | Пользователи |
|:------------------|:-------------|
| США               | 64.9 млн     |
| Япония            | 51.8 млн     |
| Бразилия          | 16.6 млн     |
| Великобритания    | 16.1 млн     |
| Индия             | 15.0 млн     |
| Индонезия         | 14.8 млн     |
| Турция            | 13.8 млн     |
| Мексика           | 11.8 млн     |
| Саудовская Аравия | 11.4 млн     |
| Франция           | 9.5 млн      |

### Ключевой функционал
- Регистрация и авторизация
- Публикация твитов
  - Твит может содержать текст до 280 символов (включая хештеги), фото и видео
  - Твит может быть либо отдельным твитом, либо ответом на другой твит
- Возможность лайкать и репостить твиты
- Поиск твитов по хештегам
- Подписка на других пользователей
- Получение ленты
  - Лента формируется на основе подписок, активности пользователя, а также рекламы
  - Лента пополняется новыми твитами в реальном времени

## 2. Расчет нагрузки

### Продуктовые метрики

- Количество зарегистрированных пользователей: 1.3 млрд [[2]](https://www.demandsage.com/twitter-statistics/)
- Месячная аудитория (MAU): 528.3 млн [[2]](https://www.demandsage.com/twitter-statistics/)
- Дневная аудитория (DAU): 237.8 млн [[2]](https://www.demandsage.com/twitter-statistics/)
- Среднее время на сайте: 30.9 минут в день [[2]](https://www.demandsage.com/twitter-statistics/)
- 100 самых популярных аккаунтов имеют более 24 миллионов подписчиков. [[3]](https://notcommon.com/most-followed/twitter)
- Количество твитов в день: 500 млн [[4]](https://blog.twitter.com/engineering/en_us/a/2013/new-tweets-per-second-record-and-how)

### Действия пользователя

Среднее количество действий пользователя по типам в день.

#### Твиты

Согласно статистике дневная аудитория Твиттера составляет 237.8 млн пользователей, которые публикуют около 500 млн твитов.
Получается, что один пользователь в среднем публикует 2 твита.
```
RPS = (500 000 000 твитов/день) / (24 * 60 * 60) = ~5790
```

#### Лайки
Будем считать, что один пользователь в среднем ставит 10 лайков в день.
```
237 800 000 польз. * 10 лайков/день = 2 378 000 000 лайков/день
RPS = (2 378 000 000 лайков/день) / (24 * 60 * 60) = ~27500
```

#### Поиск по хештегам
Большую часть времени пользователь просматривает ленту, составленную из рекомендаций.
Поиск по хештегу - относительно редко используемая функциональность.
Будем считать, что пользователь делает поиск 4 раза в неделю. ~ 0.57 раз в день.
```
237 800 000 польз. * 0.57 поисков/день = 135 546 000 поисков/день
RPS = (135 546 000 поисков/день) / (24 * 60 * 60) = ~1570
```

#### Подписки
Будем считать, что один пользователь в среднем делает одну подписку в день.
```
237 800 000 польз. * 1 подписка/день = 237 800 000 подписок/день
RPS = (237 800 000 подписок/день) / (24 * 60 * 60) = ~2750
```

| Действие         | RPS   |
|:-----------------|:------|
| Твит             | 5790  |
| Лайк             | 27500 |
| Поиск по хештегу | 1570  |
| Подписка         | 2750  |

### Размер хранилища
Средний размер хранилища пользователя в штуках и гигабайтах по типам.

> 1 текстовый твит = ~200 байт [[5]](https://www.slideshare.net/raffikrikorian/twitter-by-the-numbers)

Самые популярные твиты - это твиты с изображениями, за ними идут твиты с видео.
Обычные текстовые твиты менее всего интересны людям. [[6]](https://www.crossrivertherapy.com/research/twitter-statistics)
Поэтому большинство твитов помимо текста содержат изображения и видео.
Будем считать, что каждый твит содержит одно изображение или видео.  

Размер изображения ограничен 5 Мб, но на практике он обычно не превышает 200 Кб. Будем считать, что  
> 1 изображение = ~200 Кб

Ограничение на длину видео - 140 секунд, ограничение на размер - 512 Мб.  
Средняя продолжительность видео составляет примерно 40 секунд.
Будем считать, что большинство публикуемых видео
[[7]](https://www.equinetmedia.com/blog/a-quick-guide-to-length-for-social-media-video?hs_amp=true)

> 1 видео = ~60 Мб

---

### Технические метрики

## Источники
1. https://datareportal.com/essential-twitter-stats
2. https://www.demandsage.com/twitter-statistics/
3. https://notcommon.com/most-followed/twitter
4. https://blog.twitter.com/engineering/en_us/a/2013/new-tweets-per-second-record-and-how
5. https://www.slideshare.net/raffikrikorian/twitter-by-the-numbers
6. https://www.crossrivertherapy.com/research/twitter-statistics
7. https://www.equinetmedia.com/blog/a-quick-guide-to-length-for-social-media-video?hs_amp=true
8. https://martech.org/despite-280-character-expansion-short-tweets-are-still-the-norm/
9. https://famewall.io/statistics/twitter-stats/
10. https://www.internetlivestats.com/twitter-statistics/
